#!/usr/bin/env python

from pathlib import Path
import sys

import torch

MODEL_ROOT = Path("/opt/Ordered-Neurons")
CORPUS_PATH = MODEL_ROOT / "corpus.data"

sys.path.append(str(MODEL_ROOT))

import data
corpus = torch.load(CORPUS_PATH)

######
# Tokenize

import subprocess

tokenized = subprocess.check_output(["tokenize", sys.argv[1]]).decode("utf-8").strip()

######
# Unkify

for line in tokenized.strip().split("\n"):
    unks = [0 if token in corpus.dictionary.word2idx else 1 for token in line.strip(" ").split(" ")]
    print(" ".join(map(str, unks)))
