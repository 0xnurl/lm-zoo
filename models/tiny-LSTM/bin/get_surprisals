#!/bin/sh
TINY_ROOT="/opt/tinylstm"
INPUT_FILE="$1"

/opt/bin/tokenize $1 > /tmp/input_tokenized
python ${TINY_ROOT}/get_raw.py --vocab_file ${TINY_ROOT}/vocab.pkl /tmp/input_tokenized > /tmp/input_unkified

python ${TINY_ROOT}/eval.py \
    --corpus ${TINY_ROOT}/ptb.pt \
    --checkpoint ${TINY_ROOT}/model_small.pt \
    --eval_data /tmp/input_unkified \
    --outf /dev/stdout