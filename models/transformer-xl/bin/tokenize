#!/usr/bin/env python

import argparse
from pytorch_pretrained_bert import TransfoXLTokenizer


p = argparse.ArgumentParser()
p.add_argument("file", type=argparse.FileType("r"))
p.add_argument("-o", "--outfile", type=argparse.FileType("w"), default="-")
p.add_argument("--model", default="transfo-xl-wt103")

args = p.parse_args()

tokenizer = TransfoXLTokenizer.from_pretrained(args.model)
with args.file as f, args.outfile as o:
    for sentence in f:
        o.write("%s <eos>\n" % (" ".join(tokenizer.tokenize(sentence))))
