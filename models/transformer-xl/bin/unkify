#!/usr/bin/env python

MODEL_ROOT = "/opt/transformer-xl/transfo-xl-wt103"
VOCAB_PATH = MODEL_ROOT + "/vocab.bin"

import subprocess
import sys

import torch


vocab = set(torch.load(VOCAB_PATH)["sym2idx"].keys())


tokenized = subprocess.check_output(["tokenize", sys.argv[1]]).decode("utf-8").strip()
for line in tokenized.strip().split("\n"):
    unks = [0 if token in vocab else 1 for token in line.strip().split(" ")]
    print(" ".join(map(str, unks)))
