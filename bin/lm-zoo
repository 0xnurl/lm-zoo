#!/usr/bin/env python
# coding: utf-8


import click
import crayons
import docker
import requests


REGISTRY_URI = "https://cpllab.github.io/language-models/registry.json"


def get_registry():
    return requests.get(REGISTRY_URI).json()


@click.group()
def lm_zoo(): pass


@lm_zoo.command()
@click.option("--short", is_flag=True, default=False,
              help="Output just a list of shortnames rather than a pretty list")
def list(short):
    """
    List language models available in the central repository.
    """
    show_props = [
        ("name", "Full name"),
        ("ref_url", "Reference URL"),
        ("maintainer", "Maintainer"),
        ("datetime", "Last updated"),
    ]

    for model in get_registry()["models"]:
        if short:
            click.echo(model["shortname"])
        else:
            click.echo(crayons.normal(model["shortname"], bold=True))
            for key, label in show_props:
                click.echo("\t" + crayons.normal(label + ": ", bold=True)
                           + model.get(key, "None"))


if __name__ == "__main__":
    lm_zoo()
